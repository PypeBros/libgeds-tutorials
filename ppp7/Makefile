#---------------------------------------------------------------------------------
.SUFFIXES:
#---------------------------------------------------------------------------------
ROOT ?= $(abspath $(CURDIR)/..)
M := ppp7
CPU := arm7
INCLUDES = include #../common
LIBS = -lntxm7 -ldswifi7 -lnds7
LIBDIRS = $(LIBNTXM) $(LIBNDS)
DATA :=
include $(ROOT)/common.mk


#---------------------------------------------------------------------------------
# options for code generation
#---------------------------------------------------------------------------------

#LIBS += -lmikmod7

#-----------------------------------------------------------------------------
# list of directories containing libraries, this must be the top level 
# containing include and lib
#-----------------------------------------------------------------------------
#$(TOPDIR)/libntxm/lib

#---------------------------------------------------------------------------------
# no real need to edit anything past this point unless you need to add additional
# rules for different file extensions
#---------------------------------------------------------------------------------

#---------------------------------------------------------------------------------

TARGET	:=	$O/lib/$M.arm7
ARM7ELF	:=	$O/$M/$M.arm7.elf

# export VPATH	:=	$(foreach dir,$(SOURCES),$(CURDIR)/$(dir))

#---------------------------------------------------------------------------------
# use CXX for linking C++ projects, CC for standard C
#---------------------------------------------------------------------------------

.PHONY: $(BUILD) clean
 
#---------------------------------------------------------------------------------
clean:
	@echo clean ...
	rm -fr $(BUILD) $(LIBRARY) *.elf
 
 
#---------------------------------------------------------------------------------
 
 
#---------------------------------------------------------------------------------
# main targets
#---------------------------------------------------------------------------------
$(TARGET)	:	$(ARM7ELF)
	@$(OBJCOPY) -O binary $< $@
	@echo built ... $@


$(ARM7ELF)	:	$(OFILES) $(LIBDEPS)
#	@echo "some assembly : $(SFILE) -> $(OFILES)"
#	@echo "now linking $(notdir $@)"
#	$(LD)  $(LDFLAGS) $(OFILES) $(LIBPATHS) $(LIBS) -o $@

all: $(TARGET)

#---------------------------------------------------------------------------------
# you need a rule like this for each extension you use as binary data 
#---------------------------------------------------------------------------------
%.bin.o	:	%.bin
#---------------------------------------------------------------------------------
	@echo $(notdir $<)
	@$(bin2o)

-include $(DEPENDS)
 
#---------------------------------------------------------------------------------------